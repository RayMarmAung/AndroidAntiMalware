Imports System.IO
Imports Telecom.Android
Public Class Form1

#Region "UPATE FILE CREATOR"
    Private Sub butGenerate_Click(sender As Object, e As EventArgs) Handles butGenerate.Click
        If Not (txtVersion.Text = "" Or txtHashCode.Text = "" Or txtStringTable.Text = "" Or txtHashVersion.Text = "" Or txtStrTableVersion.Text = "") Then

            Dim Version As String = txtVersion.Text
            Dim Hash As String = txtHashCode.Text
            Dim StrTable As String = txtStringTable.Text

            If Not Version.StartsWith("Version_V") Then
                Version = "Version_V" & Version & ".TELECOM"
            End If

            Dim hashCodeFile As String = "Hash_V" & txtHashVersion.Text & ".TELECOM"
            Dim strTableFile As String = "Byte_V" & txtStrTableVersion.Text & ".TELECOM"

            Using w As New StreamWriter(Version)
                w.Close()
            End Using

            If File.Exists(Hash) Then File.Copy(Hash, hashCodeFile)
            If File.Exists(StrTable) Then File.Copy(StrTable, strTableFile)

            Zip.Run7zCommand("a TmpStr.bin " & Version & " " & hashCodeFile & " " & strTableFile & " -pTELEComTechAV77813&&*!#")

            If File.Exists(hashCodeFile) Then File.Delete(hashCodeFile)
            If File.Exists(strTableFile) Then File.Delete(strTableFile)
            If File.Exists(Version) Then File.Delete(Version)

            If File.Exists("TmpStr.bin") Then
                EncryptOrDecryptFile("TmpStr.bin", "TELEComResLib.dll", CryptoFileAction.ActionEncrypt)
                File.Delete("TmpStr.bin")
            End If

            Dim folderDlg As New FolderBrowserDialog
            folderDlg.ShowNewFolderButton = True
            If folderDlg.ShowDialog = DialogResult.OK Then
                Dim tempPath As String = folderDlg.SelectedPath

                Dim tempStr As String = Path.Combine(tempPath, "TELEComResLib.dll")
                If File.Exists(tempStr) Then File.Delete(tempStr)

                If File.Exists("TELEComResLib.dll") Then File.Move("TELEComResLib.dll", tempStr)

            End If

            MsgBox("Finish", MsgBoxStyle.OkOnly, "TELECom Developer View")

            txtHashCode.Text = ""
            txtVersion.Text = ""
            txtHashVersion.Text = ""
            txtStringTable.Text = ""
            txtStrTableVersion.Text = ""

        End If
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt|TELECOM Files (*.TELECOM)|*.TELECOM"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtHashCode.Text = openDialog.FileName
        End If

    End Sub
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt|TELECOM Files (*.TELECOM)|*.TELECOM"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtStringTable.Text = openDialog.FileName
        End If
    End Sub

#End Region

#Region "LOG FILE EXTRACTOR"
    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Log Files (*.log)|*.log"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtLogPath.Text = openDialog.FileName
        End If
    End Sub
    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click

        EncryptOrDecryptFile(txtLogPath.Text, "TmpStr.bin", CryptoFileAction.ActionDecrypt)
        Zip.Run7zCommand("e TmpStr.bin important.txt ordinary.txt rawlist.txt -pTELEComTechAV77813&&*!#")

        If File.Exists("TmpStr.bin") Then
            File.Delete("TmpStr.bin")
        End If

        Dim folderDlg As New FolderBrowserDialog
        folderDlg.ShowNewFolderButton = True
        If folderDlg.ShowDialog = DialogResult.OK Then
            Dim tempPath As String = folderDlg.SelectedPath

            Dim important As String = Path.Combine(tempPath, "important.txt")
            Dim ordinary As String = Path.Combine(tempPath, "ordinary.txt")
            Dim rawlist As String = Path.Combine(tempPath, "rawlist.txt")

            If File.Exists(important) Then File.Delete(important)
            If File.Exists(ordinary) Then File.Delete(ordinary)
            If File.Exists(rawlist) Then File.Delete(rawlist)

            If File.Exists("important.txt") Then File.Move("important.txt", important)
            If File.Exists("ordinary.txt") Then File.Move("ordinary.txt", ordinary)
            If File.Exists("rawlist.txt") Then File.Move("rawlist.txt", rawlist)

            MsgBox("Finish")

            txtLogPath.Text = ""

        End If

    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtLogFilter.Text = openDialog.FileName
        End If
    End Sub
    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        If Not txtLogFindStr.Text = "" Then

            Dim result As String = ""

            Using r As New StreamReader(txtLogFilter.Text)
                Dim line As String

                While Not r.EndOfStream
                    line = r.ReadLine

                    If line.Contains(txtLogFindStr.Text) Then
                        If result = "" Then
                            result = line
                        Else
                            result += vbNewLine & line
                        End If
                    End If
                End While

            End Using

            Using w As New StreamWriter("TempStr.txt")
                w.Write(result)
            End Using

            Dim folderDlg As New FolderBrowserDialog
            folderDlg.ShowNewFolderButton = True
            If folderDlg.ShowDialog = DialogResult.OK Then
                Dim tempPath As String = folderDlg.SelectedPath

                Dim tempStr As String = Path.Combine(tempPath, "NewHashWithFile.txt")

                If File.Exists(tempStr) Then File.Delete(tempStr)
                If File.Exists("TempStr.txt") Then File.Move("TempStr.txt", tempStr)

                MsgBox("Finish")

                txtLogFilter.Text = ""
                txtLogFindStr.Text = ""
            End If

        Else
            MsgBox("Please type the filter text", MsgBoxStyle.OkOnly)
        End If
    End Sub
    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click

        If Not txtLogFindStr.Text = "" Then

            Dim result As String = ""

            Using r As New StreamReader(txtLogFilter.Text)
                Dim line As String

                While Not r.EndOfStream
                    line = r.ReadLine

                    If line.Contains(txtLogFindStr.Text) Then
                        If result = "" Then
                            result = line.Substring(line.IndexOf(">") + 2)
                        Else
                            result += vbNewLine & line.Substring(line.IndexOf(">") + 2)
                        End If
                    End If
                End While

            End Using

            Using w As New StreamWriter("TempStr.txt")
                w.Write(result)
            End Using

            Dim folderDlg As New FolderBrowserDialog
            folderDlg.ShowNewFolderButton = True
            If folderDlg.ShowDialog = DialogResult.OK Then
                Dim tempPath As String = folderDlg.SelectedPath

                Dim tempStr As String = Path.Combine(tempPath, "NewHash.txt")

                If File.Exists(tempStr) Then File.Delete(tempStr)
                If File.Exists("TempStr.txt") Then File.Move("TempStr.txt", tempStr)

                MsgBox("Finish")

                txtLogFilter.Text = ""
                txtLogFindStr.Text = ""

            End If
        Else
            MsgBox("Please type the filter text", MsgBoxStyle.OkOnly)
        End If
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtBackup.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click

        Dim tempStr As String = ""

        Using r As New StreamReader(txtBackup.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If Not line.Contains(txtReject.Text) Then
                    If tempStr = "" Then
                        tempStr = line
                    Else
                        tempStr += vbNewLine & line
                    End If
                End If

            End While
        End Using

        Dim folderDlg As New FolderBrowserDialog
        folderDlg.ShowNewFolderButton = True
        If folderDlg.ShowDialog = DialogResult.OK Then
            Dim tempPath As String = folderDlg.SelectedPath

            Dim reject As String = Path.Combine(tempPath, "rejectString.txt")

            Using w As New StreamWriter(reject)
                w.Write(tempStr)
                w.Close()
            End Using

            MsgBox("Finish")

            txtBackup.Text = ""
            txtReject.Text = ""

        End If

    End Sub

#End Region

#Region "SERIAL ACTIVATION"
    Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged

        If TextBox1.TextLength = 16 Then

            Dim uniqueNo As String = TextBox1.Text
            uniqueNo = HashString(HashString(HashString(HashString(HashString(uniqueNo, HashTypeAlgo.MD5), HashTypeAlgo.SHA1), HashTypeAlgo.SHA256), HashTypeAlgo.SHA384), HashTypeAlgo.SHA512)

            TripleDes.Key = TruncateHash(TextBox1.Text, TripleDes.KeySize \ 8)
            TripleDes.IV = TruncateHash(TextBox1.Text, TripleDes.BlockSize \ 8)
            uniqueNo = EncryptData(uniqueNo).ToUpper.Replace("+", "").Replace("=", "").Replace("/", "").Replace("O", "0").Replace("I", "1").Replace("L", "1").Replace("B", "8").Replace("S", "5")

            Dim result As String = uniqueNo.Substring(0, 1) & uniqueNo.Substring(uniqueNo.Length - 1) & uniqueNo.Substring(1, 1) & uniqueNo.Substring(uniqueNo.Length - 2, 1) & "-" &
                                   uniqueNo.Substring(2, 1) & uniqueNo.Substring(uniqueNo.Length - 3, 1) & uniqueNo.Substring(3, 1) & uniqueNo.Substring(uniqueNo.Length - 4, 1) & "-" &
                                   uniqueNo.Substring(4, 1) & uniqueNo.Substring(uniqueNo.Length - 5, 1) & uniqueNo.Substring(5, 1) & uniqueNo.Substring(uniqueNo.Length - 6, 1) & "-" &
                                   uniqueNo.Substring(6, 1) & uniqueNo.Substring(uniqueNo.Length - 7, 1) & uniqueNo.Substring(7, 1) & uniqueNo.Substring(uniqueNo.Length - 8, 1)

            TextBox2.Text = result

        Else
            TextBox2.Text = ""
        End If

    End Sub

    Private Sub Button13_Click(sender As Object, e As EventArgs) Handles Button13.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtREmoveHash.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button14_Click(sender As Object, e As EventArgs) Handles Button14.Click

        Dim result As String = ""

        Using r As New StreamReader(txtREmoveHash.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If result = "" Then
                    result = line
                Else
                    If Not checkHashChecksum(result, line) Then
                        result += vbNewLine & line
                    End If
                End If

            End While
        End Using

        Using w As New StreamWriter("CleanChecksum.txt")
            w.Write(result)
        End Using

        Dim folderDlg As New FolderBrowserDialog
        folderDlg.ShowNewFolderButton = True
        If folderDlg.ShowDialog = DialogResult.OK Then
            Dim tempPath As String = folderDlg.SelectedPath

            If File.Exists(Path.Combine(tempPath, "CleanChecksum.txt")) Then File.Delete(Path.Combine(tempPath, "CleanChecksum.txt"))
            File.Move("CleanChecksum.txt", Path.Combine(tempPath, "CleanChecksum.txt"))

            txtREmoveHash.Text = ""
            MsgBox("Finish")

        End If

    End Sub
    Private Function checkHashChecksum(list As String, txt As String) As Boolean

        Dim result As Boolean = False

        Using r As New StringReader(list)
            Dim line As String

            While Not r.Peek = -1
                line = r.ReadLine

                If line.Contains(txt) Then
                    result = True
                    Exit While
                End If

            End While
        End Using

        Return result
    End Function

    Private Sub Button10_Click(sender As Object, e As EventArgs) Handles Button10.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtSource.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button11_Click(sender As Object, e As EventArgs) Handles Button11.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            txtDist.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button12_Click(sender As Object, e As EventArgs) Handles Button12.Click

        Dim result As String = ""

        Using r As New StreamReader(txtDist.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If Not searchHash(line) Then
                    If result = "" Then
                        result = line
                    Else
                        result += vbNewLine & line
                    End If
                End If

            End While
        End Using

        Dim oldString As String
        Using r As New StreamReader(txtSource.Text)
            oldString = r.ReadToEnd
        End Using

        If Not result = "" Then
            oldString += vbNewLine & result
        Else
            Exit Sub
        End If

        Using w As New StreamWriter("NewHashCheck.txt")
            w.Write(oldString)
        End Using

        Dim folderDlg As New FolderBrowserDialog
        folderDlg.ShowNewFolderButton = True
        If folderDlg.ShowDialog = DialogResult.OK Then
            Dim tempPath As String = folderDlg.SelectedPath

            If File.Exists(Path.Combine(tempPath, "NewHashChecksum.txt")) Then File.Delete(Path.Combine(tempPath, "NewHashChecksum.txt"))
            File.Move("NewHashChecksum.txt", Path.Combine(tempPath, "NewHashChecksum.txt"))

            txtSource.Text = ""
            txtDist.Text = ""
            MsgBox("Finish")

        End If

    End Sub
    Private Function searchHash(txt As String) As String

        Dim result As Boolean = False

        Using r As New StreamReader(txtSource.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If line = txt Then
                    result = True
                    Exit While
                End If
            End While
        End Using

        Return result
    End Function

    Private Sub Button16_Click(sender As Object, e As EventArgs) Handles Button16.Click

        Dim folderDlg As New FolderBrowserDialog
        folderDlg.ShowNewFolderButton = True
        If folderDlg.ShowDialog = DialogResult.OK Then
            txtApkPath.Text = folderDlg.SelectedPath
        End If

    End Sub
    Private Function getPackageName(apkfile As String) As String

        Dim result As String = ""
        If apkfile.Contains(" ") Then apkfile = """" & apkfile & """"

        ' Dim spl() As String = apkfile.Split("\")
        'Dim name As String = spl(spl.Length - 1)
        'If Not File.Exists(name) Then File.Copy(apkfile, name)

        Dim apkInfo As String = Aapt.RunAaptCommand("dump badging " & apkfile)


        Using r As New StringReader(apkInfo)
            Dim line As String

            While Not r.Peek = -1
                line = r.ReadLine

                If line.StartsWith("package: name") Then
                    result = line.Substring(line.IndexOf("=") + 1)
                    If result.Contains("versionCode") Then
                        result = result.Substring(0, result.IndexOf("versionCode") - 1)
                    End If
                    If result.Contains("'") Then result = result.Replace("'", "")
                End If
            End While
        End Using

        Return result
    End Function

    Private Sub Button15_Click(sender As Object, e As EventArgs) Handles Button15.Click
        If Not txtApkPath.Text = "" Then

            Dim pkgNames As String = ""

            For Each files As String In Directory.GetFiles(txtApkPath.Text)
                If files.ToUpper.Contains(".APK") Then
                    Dim tmpPkg As String = getPackageName(files)

                    If Not tmpPkg = "" Then
                        If pkgNames = "" Then
                            pkgNames = tmpPkg
                        Else
                            If Not getString(pkgNames, tmpPkg) Then
                                pkgNames += vbNewLine & tmpPkg
                            End If
                        End If
                    End If

                End If
            Next

            Dim saveDialog As New SaveFileDialog
            saveDialog.Filter = "Text Files (*.txt)|*.txt"
            If saveDialog.ShowDialog <> DialogResult.Cancel Then
                Using w As New StreamWriter(saveDialog.FileName)
                    w.Write(pkgNames)
                End Using
            End If

            MsgBox("Finish")

        End If
    End Sub
    Private Function getString(filelist As String, findstr As String) As Boolean
        Dim result As Boolean = False
        Using r As New StringReader(filelist)
            Dim line As String

            While Not r.Peek = -1
                line = r.ReadLine

                If line = findstr Then
                    result = True
                    Exit While
                End If

            End While
        End Using

        Return result
    End Function

    Private Sub Button18_Click(sender As Object, e As EventArgs) Handles Button18.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            TextBox3.Text = openDialog.FileName
        End If
    End Sub
    Public checksum As String = ""
    Public PkgName As String = ""
    Private includeList As String = ""
    Private Sub Button17_Click(sender As Object, e As EventArgs) Handles Button17.Click

        Dim result As String = ""

        Using r As New StreamReader("Resources\Checksum.txt")
            checksum = r.ReadToEnd
        End Using

        Using s As New StreamReader("Resources\Pkg.txt")
            PkgName = s.ReadToEnd
        End Using

        Using r As New StreamReader(TextBox3.Text)
            Dim line As String = ""
            While Not r.EndOfStream
                line = r.ReadLine

                If Not SearchinChecksum(line) Then
                    If Not SearchinPkgName(line) Then
                        If result = "" Then
                            result = line
                        Else
                            result += vbNewLine & line
                        End If
                    End If
                End If

            End While
        End Using

        Dim saveDialog As New SaveFileDialog
        saveDialog.Filter = "Text Files (*.txt)|*.txt"
        If saveDialog.ShowDialog <> DialogResult.Cancel Then

            Using r As New StreamWriter(saveDialog.FileName)
                r.Write(result)
            End Using

        End If

        Dim saveDialog2 As New SaveFileDialog
        saveDialog2.Filter = "Text Files (*.txt)|*.txt"
        If saveDialog2.ShowDialog <> DialogResult.Cancel Then

            Using r As New StreamWriter(saveDialog2.FileName)
                r.Write(includeList)
            End Using

        End If

    End Sub
    Private Function SearchinChecksum(cFile As String) As Boolean

        Dim chk As String = ""

        If cFile.Contains(">") Then
            Dim spl() As String = cFile.Split(">"c)
            chk = spl(1).Replace(" "c, "")
        End If

        Dim result As Boolean = False

        Using r As New StringReader(checksum)
            Dim line As String

            While Not r.Peek = -1
                line = r.ReadLine

                If chk = line Then

                    If includeList = "" Then
                        includeList = cFile
                    Else
                        includeList += vbNewLine & cFile
                    End If

                    result = True
                    Exit While
                End If

            End While
        End Using

        Return result
    End Function
    Private Function SearchinPkgName(cFile As String) As Boolean

        Dim pkg As String = ""
        If cFile.Contains(">") Then
            Dim spl() As String = cFile.Split(">"c)
            If spl.Length > 1 Then
                pkg = spl(spl.Length - 1)
                If pkg.Contains(" ") Then pkg = pkg.Replace(" ", "")
            End If
        End If

        Dim result As Boolean = False

        Using r As New StringReader(PkgName)
            Dim line As String

            While Not r.Peek = -1
                line = r.ReadLine

                If pkg = line Then

                    If includeList = "" Then
                        includeList = cFile
                    Else
                        includeList += vbNewLine & cFile
                    End If

                    result = True
                    Exit While
                End If

            End While
        End Using

        Return result
    End Function

    Private Sub Button19_Click(sender As Object, e As EventArgs) Handles Button19.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            TextBox4.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button20_Click(sender As Object, e As EventArgs) Handles Button20.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            TextBox5.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button21_Click(sender As Object, e As EventArgs) Handles Button21.Click

        Dim sourceList As List(Of String) = New List(Of String)
        Dim result As String = ""

        Using r As New StreamReader(TextBox4.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If Not line = "" Then
                    Dim hash As String = line.Substring(0, line.IndexOf(" "))
                    If hash.Contains(" ") Then hash = hash.Replace(" ", "")

                    sourceList.Add(hash)

                End If

            End While

        End Using

        Using r As New StreamReader(TextBox5.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine

                If Not line = "" Then

                    If line.Contains(" ") Then line = line.Replace(" ", "")

                    If Not sourceList.Contains(line) Then
                        If result = "" Then
                            result = line
                        Else
                            result += vbNewLine & line
                        End If
                    End If

                End If

            End While
        End Using

        MsgBox(result)

        Dim saveDialog2 As New SaveFileDialog
        saveDialog2.Filter = "Text Files (*.txt)|*.txt"
        If saveDialog2.ShowDialog <> DialogResult.Cancel Then

            Using r As New StreamWriter(saveDialog2.FileName)
                r.Write(result)
            End Using

        End If

    End Sub

    Private Sub Button23_Click(sender As Object, e As EventArgs) Handles Button23.Click

        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            TextBox6.Text = openDialog.FileName
        End If

    End Sub

    Private Sub Button22_Click(sender As Object, e As EventArgs) Handles Button22.Click

        Dim clean As List(Of String) = New List(Of String)
        Dim virus As List(Of String) = New List(Of String)
        Dim pkgs As List(Of String) = New List(Of String)
        Dim result As String = ""

        Using r1 As New StreamReader("Resources\CleanList.txt")
            Dim line As String

            While Not r1.EndOfStream
                line = r1.ReadLine

                If Not line = "" Then
                    clean.Add(line)
                End If

            End While

        End Using

        Using r2 As New StreamReader("Resources\Database.txt")
            Dim line As String

            While Not r2.EndOfStream
                line = r2.ReadLine

                If Not line = "" Then
                    Dim tmp As String = line.Substring(0, line.IndexOf(" ")).Replace(" ", "")

                    virus.Add(tmp)

                End If

            End While
        End Using

        Using r3 As New StreamReader("Resources\CleanPkg.txt")
            Dim line As String

            While Not r3.EndOfStream
                line = r3.ReadLine

                If Not line = "" Then
                    pkgs.Add(line)
                End If

            End While

        End Using

        Using r3 As New StreamReader(TextBox6.Text)
            Dim line As String

            While Not r3.EndOfStream
                line = r3.ReadLine

                If Not line = "" Then

                    If line.Contains(">") Then

                        Dim tmp As String = line.Substring(line.IndexOf(">") + 1).Replace(" ", "")
                        Dim tmpkg As String = ""
                        If tmp.Contains(">") Then
                            tmpkg = tmp.Substring(tmp.IndexOf(">") + 1).Replace(" ", "")
                            tmp = tmp.Substring(0, tmp.IndexOf(">"))
                        End If

                        If Not clean.Contains(tmp) Then
                            If Not virus.Contains(tmp) Then

                                If Not pkgs.Contains(tmpkg) Then
                                    If result = "" Then
                                        result = line
                                    Else
                                        result += vbNewLine & line
                                    End If
                                End If

                            End If
                        End If
                    End If

                End If

            End While
        End Using

        Dim saveDialog2 As New SaveFileDialog
        saveDialog2.Filter = "Text Files (*.txt)|*.txt"
        If saveDialog2.ShowDialog <> DialogResult.Cancel Then

            Using r As New StreamWriter(saveDialog2.FileName)
                r.Write(result)
            End Using

        End If

    End Sub

    Private Sub Button24_Click(sender As Object, e As EventArgs) Handles Button24.Click

        Dim result As String = ""

        Using r As New StreamReader("Resources\Database.txt")
            Dim line As String


            While Not r.EndOfStream
                line = r.ReadLine

                If Not line = "" Then
                    line = line.Substring(0, line.IndexOf(" ")).Replace(" ", "")

                    If result = "" Then
                        result = line
                    Else
                        result += vbNewLine & line
                    End If

                End If

            End While

        End Using

        Dim saveDialog2 As New SaveFileDialog
        saveDialog2.Filter = "Text Files (*.txt)|*.txt"
        If saveDialog2.ShowDialog <> DialogResult.Cancel Then

            Using w As New StreamWriter(saveDialog2.FileName)
                w.Write(result)
            End Using

        End If

    End Sub

    Private Sub Button26_Click(sender As Object, e As EventArgs) Handles Button26.Click
        Dim openDialog As New OpenFileDialog
        openDialog.Filter = "Text Files (*.txt)|*.txt"
        If openDialog.ShowDialog <> DialogResult.Cancel Then
            TextBox7.Text = openDialog.FileName
        End If
    End Sub

    Private Sub Button25_Click(sender As Object, e As EventArgs) Handles Button25.Click

        Dim result As String = ""
        Dim result2 As String = ""
        Dim tmpList As List(Of String) = New List(Of String)


        Using r As New StreamReader(TextBox7.Text)
            Dim line As String

            While Not r.EndOfStream
                line = r.ReadLine()

                If Not line = "" Then

                    Dim hash = line.Substring(0, line.IndexOf(":") - 1).Replace(" ", "")

                    If Not tmpList.Contains(hash) Then

                        If result = "" Then
                            result = line
                        Else
                            result += vbNewLine & line
                        End If

                        tmpList.Add(hash)
                    Else
                        If result2 = "" Then
                            result2 = line
                        Else
                            result2 += vbNewLine & line
                        End If
                    End If

                End If

            End While

            Dim saveDialog2 As New SaveFileDialog
            saveDialog2.Filter = "Text Files (*.txt)|*.txt"
            If saveDialog2.ShowDialog <> DialogResult.Cancel Then

                Using w As New StreamWriter(saveDialog2.FileName)
                    w.Write(result)
                End Using

            End If

            Dim saveDialog3 As New SaveFileDialog
            saveDialog3.Filter = "Text Files (*.txt)|*.txt"
            If saveDialog3.ShowDialog <> DialogResult.Cancel Then

                Using w As New StreamWriter(saveDialog3.FileName)
                    w.Write(result2)
                End Using

            End If


        End Using
    End Sub

#End Region

End Class
