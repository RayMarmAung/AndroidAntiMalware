Imports System.IO
Public Class Warning3
    Dim drag As Boolean
    Dim mousex As Integer
    Dim mousey As Integer
    Private Sub butOK_ClickButtonArea(Sender As Object, e As MouseEventArgs) Handles butOK.ClickButtonArea
        If Not Directory.Exists(Path.Combine(Application.StartupPath, "Logs")) Then
            Directory.CreateDirectory(Path.Combine(Application.StartupPath, "Logs"))
        End If

        Dim proc As String = "Explorer.exe"
        Dim args As String = ControlChars.Quote & Path.Combine(Application.StartupPath, "Logs") & ControlChars.Quote
        Process.Start(proc, args)

        prepareRescan()
        Me.Close()

    End Sub
    Private Sub CButton1_ClickButtonArea(Sender As Object, e As MouseEventArgs) Handles CButton1.ClickButtonArea
        prepareRescan()
        Me.Close()
    End Sub
    Private Sub PictureBox3_MouseDown(sender As Object, e As MouseEventArgs) Handles PictureBox3.MouseDown, PictureBox11.MouseDown, PictureBox1.MouseDown
        drag = True
        mousex = Windows.Forms.Cursor.Position.X - Me.Left
        mousey = Windows.Forms.Cursor.Position.Y - Me.Top
    End Sub
    Private Sub PictureBox3_MouseMove(sender As Object, e As MouseEventArgs) Handles PictureBox3.MouseMove, PictureBox11.MouseMove, PictureBox1.MouseMove
        If drag Then
            Me.Top = Windows.Forms.Cursor.Position.Y - mousey
            Me.Left = Windows.Forms.Cursor.Position.X - mousex
        End If
    End Sub
    Private Sub PictureBox3_MouseUp(sender As Object, e As MouseEventArgs) Handles PictureBox3.MouseUp, PictureBox11.MouseUp, PictureBox1.MouseUp
        drag = False
    End Sub
    Private Sub PictureBox8_Click(sender As Object, e As EventArgs) Handles PictureBox8.Click
        prepareRescan()
        Me.Close()
    End Sub
    Private Sub PictureBox8_MouseLeave(sender As Object, e As EventArgs) Handles PictureBox8.MouseLeave
        PictureBox8.Image = Image.FromStream(New FileStream("Resources\AdbWinC.dll", FileMode.Open, FileAccess.Read))
    End Sub
    Private Sub PictureBox8_MouseMove(sender As Object, e As MouseEventArgs) Handles PictureBox8.MouseMove
        PictureBox8.Image = Image.FromStream(New FileStream("Resources\AdbWinD.dll", FileMode.Open, FileAccess.Read))
    End Sub
    Private Sub prepareRescan()
        With Form1

            .lbItems.Text = "Information"
            .Log.Text = ""
            .Status.Text = "Ready"
            .lbStatus.Text = "Status"
            .Virus.Text = ""
            .Progress.Text = "Read to Scan"
            .butScan.Text = "Rescan"

            .butFactory.ForeColor = Color.GreenYellow
            .butFactory.BorderColor = Color.GreenYellow

            .butJunk.ForeColor = Color.GreenYellow
            .butJunk.BorderColor = Color.GreenYellow

            .butDalvik.ForeColor = Color.GreenYellow
            .butDalvik.BorderColor = Color.GreenYellow

            If isRoot Or isInsecure Then
                .rdFull.Enabled = True
                .rdFull.Checked = True
                .lbFull.ForeColor = Color.GreenYellow

                .rdQuick.Enabled = True
                .lbQuick.ForeColor = Color.GreenYellow

            Else

                .rdQuick.Enabled = True
                .rdQuick.Checked = True
                .lbQuick.ForeColor = Color.GreenYellow

                .rdFull.Enabled = False
                .lbFull.ForeColor = Color.White

            End If

            resetScanVariable()

        End With
    End Sub
End Class